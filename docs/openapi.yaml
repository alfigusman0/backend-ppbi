openapi: 3.0.3
info:
  title: API PPBI - Persatuan Penggemar Bonsai Indonesia
  version: 1.7.0
  description: |
    API untuk sistem Persatuan Penggemar Bonsai Indonesia (PPBI)
    Menyediakan layanan autentikasi, manajemen pengguna, event, dan berbagai fitur terkait bonsai.
  contact:
    name: PPBI Support
  x-changelog:
    version: '1.7.0'
    date: '2024-06-26'
    changes:
      - 'ADDED: Modul Settings Kelurahan dengan CRUD operations lengkap'
      - 'ADDED: Validasi lengkap untuk data kelurahan (kode, kecamatan, nama, status)'
      - 'ADDED: Redis caching untuk data kelurahan dengan berbagai filter'
      - 'ADDED: Role-based access control untuk operasi kelurahan'
      - 'ADDED: Foreign key relationship dengan tabel kecamatan'
      - 'COMPLETED: Hierarki data geografis lengkap (provinsi → kabupaten/kota → kecamatan → kelurahan)'
      - 'ENHANCED: Pagination dan filtering untuk data master kelurahan'
    previous_versions:
      - version: '1.6.0'
        date: '2024-06-25'
        changes:
          - 'ADDED: Modul Settings Kecamatan dengan CRUD operations lengkap'
          - 'ADDED: Validasi lengkap untuk data kecamatan (kode, kabupaten/kota, nama, status)'
          - 'ADDED: Redis caching untuk data kecamatan dengan berbagai filter'
          - 'ADDED: Role-based access control untuk operasi kecamatan'
          - 'ADDED: Foreign key relationship dengan tabel kabupaten/kota'
          - 'ENHANCED: Pagination dan filtering untuk data master kecamatan'
      - version: '1.5.0'
        date: '2024-06-24'
        changes:
          - 'ADDED: Modul Settings Kabupaten/Kota dengan CRUD operations lengkap'
          - 'ADDED: Validasi lengkap untuk data kabupaten/kota (kode, provinsi, nama, status)'
          - 'ADDED: Redis caching untuk data kabupaten/kota dengan berbagai filter'
          - 'ADDED: Role-based access control untuk operasi kabupaten/kota'
          - 'ADDED: Foreign key relationship dengan tabel provinsi'
          - 'ENHANCED: Pagination dan filtering untuk data master kabupaten/kota'
      - version: '1.4.0'
        date: '2024-06-23'
        changes:
          - 'ADDED: Modul Settings Provinsi dengan CRUD operations lengkap'
          - 'ADDED: Validasi lengkap untuk data provinsi (kode, nama, pulau, status)'
          - 'ADDED: Redis caching untuk data provinsi dengan berbagai filter'
          - 'ADDED: Role-based access control untuk operasi provinsi'
          - 'ADDED: Support untuk enum pulau (PAPUA, KALIMANTAN, SUMATERA, dll)'
          - 'ENHANCED: Pagination dan filtering untuk data master provinsi'
      - version: '1.3.0'
        date: '2024-06-22'
        changes:
          - 'ADDED: Modul Profile Management dengan CRUD operations lengkap'
          - 'ADDED: Validasi lengkap untuk data profile (nama, jenis kelamin, alamat, dll)'
          - 'ADDED: Redis caching untuk profile data dengan berbagai filter'
          - 'ADDED: Role-based access control untuk operasi profile'
          - 'ADDED: Support untuk data geografis (provinsi, kabupaten, kecamatan, kelurahan)'
          - 'ENHANCED: Pagination dan filtering advanced untuk profile'
      - version: '1.2.0'
        date: '2024-06-21'
        changes:
          - 'ADDED: Modul Users Management dengan CRUD operations lengkap'
          - 'ADDED: Fitur import users dari Excel dengan validasi'
          - 'ADDED: Endpoint preview Excel sebelum import'
          - 'ADDED: Download template Excel untuk import'
          - 'ADDED: Pagination dan filtering untuk list users'
          - 'ADDED: Redis caching untuk performance users data'
          - 'ENHANCED: Security dengan role-based access control'
      - version: '1.1.0'
        date: '2024-06-20'
        changes:
          - 'INITIAL: Dokumentasi API lengkap dengan OpenAPI 3.0.3'
          - 'ADDED: Authentication module dengan JWT dan OAuth2 Google'
          - 'ADDED: Basic API structure dan error handling'
          - 'ADDED: Documentation endpoints (Swagger UI, OpenAPI spec, health check)'

servers:
  - url: http://localhost:5000/api
    description: Lokal Development Server
    variables:
      port:
        default: '5000'
  - url: https://apps.ppbindonesia.com/api
    description: Development Server
    x-environment: development
  - url: https://apps.ppbindonesia.org/api
    description: Production Server
    x-environment: production

tags:
  - name: Documentation
    description: Endpoint dokumentasi API
  - name: Authentication
    description: Operasi terkait autentikasi dan autorisasi
  - name: Users
    description: Manajemen data pengguna
  - name: Profile
    description: Manajemen profil pengguna
  - name: Settings - Provinsi
    description: Manajemen data master provinsi
  - name: Settings - Kabupaten/Kota
    description: Manajemen data master kabupaten/kota
  - name: Settings - Kecamatan
    description: Manajemen data master kecamatan
  - name: Settings - Kelurahan
    description: Manajemen data master kelurahan

paths:
  /:
    get:
      summary: Root endpoint - Informasi API
      description: Menampilkan informasi dasar API dan dokumentasi
      tags:
        - Documentation
      responses:
        '200':
          description: Informasi API berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIInfo'
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /docs:
    get:
      summary: Dokumentasi API - Swagger UI
      description: Menampilkan dokumentasi API interaktif
      tags:
        - Documentation
      responses:
        '200':
          description: Dokumentasi berhasil ditampilkan
          content:
            text/html:
              schema:
                type: string
        '404':
          description: File dokumentasi tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api-spec:
    get:
      summary: OpenAPI Specification
      description: Mendapatkan file spesifikasi OpenAPI YAML
      tags:
        - Documentation
      responses:
        '200':
          description: Spesifikasi berhasil diambil
          content:
            application/yaml:
              schema:
                type: string
        '404':
          description: File spesifikasi tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /docs-health:
    get:
      summary: Health Check Dokumentasi
      description: Memeriksa status kesehatan file dokumentasi
      tags:
        - Documentation
      responses:
        '200':
          description: Dokumentasi sehat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DocsHealth'
        '503':
          description: Dokumentasi tidak sehat
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api:
    get:
      summary: Health Check API
      description: Memeriksa status kesehatan API
      tags:
        - Documentation
      responses:
        '200':
          description: API sehat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIHealth'

  # ============================================
  # AUTHENTICATION ENDPOINTS
  # ============================================
  /api/auth/login:
    post:
      summary: Login pengguna
      description: Autentikasi pengguna dengan username dan password
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login berhasil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: Validasi gagal atau kredensial salah
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/auth/register:
    post:
      summary: Registrasi pengguna baru
      description: Mendaftarkan pengguna baru ke sistem
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '200':
          description: Registrasi berhasil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterResponse'
        '400':
          description: Validasi gagal atau username sudah ada
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/auth/logout:
    get:
      summary: Logout pengguna
      description: Menghapus session dan token pengguna
      tags:
        - Authentication
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logout berhasil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogoutResponse'
        '400':
          description: Tidak ada session aktif
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/auth/check:
    get:
      summary: Cek status token
      description: Memeriksa apakah token masih aktif
      tags:
        - Authentication
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Token masih aktif
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckTokenResponse'
        '401':
          description: Token tidak valid
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/auth/google:
    get:
      summary: Login dengan Google OAuth2
      description: Redirect ke halaman autentikasi Google
      tags:
        - Authentication
      responses:
        '302':
          description: Redirect ke Google OAuth
          headers:
            Location:
              schema:
                type: string
                example: 'https://accounts.google.com/o/oauth2/auth?response_type=code...'

  /api/auth/google/callback:
    get:
      summary: Callback Google OAuth2
      description: Endpoint callback untuk autentikasi Google
      tags:
        - Authentication
      parameters:
        - name: code
          in: query
          required: true
          schema:
            type: string
      responses:
        '302':
          description: Redirect ke frontend dengan token
          headers:
            Location:
              schema:
                type: string
                example: 'http://frontend.url/auth/google/token_jwt_string'
        '400':
          description: Gagal mendapatkan informasi user dari Google
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/auth/token/create:
    post:
      summary: Buat token baru
      description: Membuat token JWT baru dengan payload custom
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTokenRequest'
      responses:
        '200':
          description: Token berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: Payload tidak valid
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/auth/token:
    post:
      summary: Refresh token
      description: Memperbarui token dengan payload baru
      tags:
        - Authentication
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: Token berhasil di-refresh
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: Payload tidak valid atau tidak ada session
        '500':
          $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Hapus token
      description: Menghapus token dari sistem (logout paksa)
      tags:
        - Authentication
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteTokenRequest'
      responses:
        '200':
          description: Token berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogoutResponse'
        '400':
          description: Tidak ada session aktif
        '404':
          description: Token tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # USERS MANAGEMENT ENDPOINTS
  # ============================================
  /api/users:
    get:
      summary: Get list of users
      description: Mendapatkan daftar pengguna dengan pagination, filtering, dan caching Redis
      tags:
        - Users
      security:
        - bearerAuth: []
      parameters:
        - name: id_user
          in: query
          schema:
            type: integer
          description: Filter by user ID
        - name: username
          in: query
          schema:
            type: string
          description: Filter by username
        - name: ids_level
          in: query
          schema:
            type: string
          description: Filter by level IDs (comma separated)
        - name: level
          in: query
          schema:
            type: string
          description: Filter by level name
        - name: ids_grup
          in: query
          schema:
            type: string
          description: Filter by group IDs (comma separated)
        - name: grup
          in: query
          schema:
            type: string
          description: Filter by group name
        - name: keterangan
          in: query
          schema:
            type: string
          description: Filter by description
        - name: reset
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Filter by reset status
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: order_by
          in: query
          schema:
            type: string
            default: 'created_at DESC'
          description: Order by field
      responses:
        '200':
          description: Daftar pengguna berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UsersListResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create new user
      description: Membuat pengguna baru dengan validasi strong password
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
      responses:
        '200':
          description: Pengguna berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateUserResponse'
        '400':
          description: Validasi gagal atau data sudah ada
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/users/single:
    get:
      summary: Get single user
      description: Mendapatkan data satu pengguna dengan caching Redis
      tags:
        - Users
      security:
        - bearerAuth: []
      parameters:
        - name: id_user
          in: query
          schema:
            type: integer
          description: User ID
        - name: username
          in: query
          schema:
            type: string
          description: Username
        - name: ids_level
          in: query
          schema:
            type: string
          description: Level IDs (comma separated)
        - name: level
          in: query
          schema:
            type: string
          description: Level name
        - name: ids_grup
          in: query
          schema:
            type: string
          description: Group IDs (comma separated)
        - name: grup
          in: query
          schema:
            type: string
          description: Group name
        - name: keterangan
          in: query
          schema:
            type: string
          description: Description
        - name: reset
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Reset status
      responses:
        '200':
          description: Data pengguna berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/users/{id}:
    put:
      summary: Update user
      description: Mengupdate data pengguna dengan validasi role-based access
      tags:
        - Users
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      responses:
        '200':
          description: Data pengguna berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Validasi gagal atau data tidak berubah
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete user
      description: Menghapus pengguna dengan validasi role-based access
      tags:
        - Users
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Pengguna berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # USERS IMPORT ENDPOINTS
  # ============================================
  /api/users/import/excel:
    post:
      summary: Import users from Excel
      description: Mengimpor data pengguna dari file Excel dengan validasi lengkap
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file (.xlsx, .xls)
      responses:
        '200':
          description: Import berhasil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportResponse'
        '400':
          description: File tidak valid atau data duplikasi
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/users/import/preview:
    post:
      summary: Preview Excel before import
      description: Preview data Excel sebelum melakukan import dengan validasi struktur
      tags:
        - Users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file (.xlsx, .xls)
      responses:
        '200':
          description: Preview berhasil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PreviewResponse'
        '400':
          description: File tidak valid
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/users/import/download-template:
    get:
      summary: Download Excel template
      description: Mendownload template Excel untuk import pengguna dengan format yang benar
      tags:
        - Users
      responses:
        '200':
          description: Template berhasil didownload
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
          headers:
            Content-Disposition:
              schema:
                type: string
                example: 'attachment; filename=Template_Import_Users.xlsx'
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # PROFILE MANAGEMENT ENDPOINTS
  # ============================================
  /api/profile:
    get:
      summary: Get list of profiles
      description: Mendapatkan daftar profil dengan pagination, filtering, dan caching Redis
      tags:
        - Profile
      security:
        - bearerAuth: []
      parameters:
        - name: id_profile
          in: query
          schema:
            type: string
          description: Filter by profile IDs (comma separated)
        - name: username
          in: query
          schema:
            type: string
          description: Filter by username
        - name: ids_level
          in: query
          schema:
            type: string
          description: Filter by level IDs (comma separated)
        - name: level
          in: query
          schema:
            type: string
          description: Filter by level name
        - name: ids_grup
          in: query
          schema:
            type: string
          description: Filter by group IDs (comma separated)
        - name: grup
          in: query
          schema:
            type: string
          description: Filter by group name
        - name: nama_lengkap
          in: query
          schema:
            type: string
          description: Filter by full name
        - name: jenis_kelamin
          in: query
          schema:
            type: string
            enum: ['LAKI-LAKI', 'PEREMPUAN']
          description: Filter by gender
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Filter by province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Filter by province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Filter by province name
        - name: pulau
          in: query
          schema:
            type: string
          description: Filter by island
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: Filter by city IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Filter by city codes (comma separated)
        - name: kabkota
          in: query
          schema:
            type: string
          description: Filter by city name
        - name: ids_kecamatan
          in: query
          schema:
            type: string
          description: Filter by district IDs (comma separated)
        - name: kode_kecamatan
          in: query
          schema:
            type: string
          description: Filter by district codes (comma separated)
        - name: kecamatan
          in: query
          schema:
            type: string
          description: Filter by district name
        - name: ids_kelurahan
          in: query
          schema:
            type: string
          description: Filter by village IDs (comma separated)
        - name: kode_kelurahan
          in: query
          schema:
            type: string
          description: Filter by village codes (comma separated)
        - name: kelurahan
          in: query
          schema:
            type: string
          description: Filter by village name
        - name: nmr_tlpn
          in: query
          schema:
            type: string
          description: Filter by phone number
        - name: created_by
          in: query
          schema:
            type: integer
          description: Filter by creator ID
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: order_by
          in: query
          schema:
            type: string
            default: 'created_at DESC'
          description: Order by field
      responses:
        '200':
          description: Daftar profil berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProfileListResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create new profile
      description: Membuat profil baru dengan validasi lengkap
      tags:
        - Profile
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProfileRequest'
      responses:
        '200':
          description: Profil berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateProfileResponse'
        '400':
          description: Validasi gagal
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/profile/single:
    get:
      summary: Get single profile
      description: Mendapatkan data satu profil dengan caching Redis
      tags:
        - Profile
      security:
        - bearerAuth: []
      parameters:
        - name: id_profile
          in: query
          schema:
            type: integer
          description: Profile ID
        - name: username
          in: query
          schema:
            type: string
          description: Username
        - name: ids_level
          in: query
          schema:
            type: string
          description: Level IDs (comma separated)
        - name: level
          in: query
          schema:
            type: string
          description: Level name
        - name: ids_grup
          in: query
          schema:
            type: string
          description: Group IDs (comma separated)
        - name: grup
          in: query
          schema:
            type: string
          description: Group name
        - name: nama_lengkap
          in: query
          schema:
            type: string
          description: Full name
        - name: jenis_kelamin
          in: query
          schema:
            type: string
            enum: ['LAKI-LAKI', 'PEREMPUAN']
          description: Gender
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Province name
        - name: pulau
          in: query
          schema:
            type: string
          description: Island
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: City IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: City codes (comma separated)
        - name: kabkota
          in: query
          schema:
            type: string
          description: City name
        - name: ids_kecamatan
          in: query
          schema:
            type: string
          description: District IDs (comma separated)
        - name: kode_kecamatan
          in: query
          schema:
            type: string
          description: District codes (comma separated)
        - name: kecamatan
          in: query
          schema:
            type: string
          description: District name
        - name: ids_kelurahan
          in: query
          schema:
            type: string
          description: Village IDs (comma separated)
        - name: kode_kelurahan
          in: query
          schema:
            type: string
          description: Village codes (comma separated)
        - name: kelurahan
          in: query
          schema:
            type: string
          description: Village name
        - name: nmr_tlpn
          in: query
          schema:
            type: string
          description: Phone number
        - name: created_by
          in: query
          schema:
            type: integer
          description: Creator ID
      responses:
        '200':
          description: Data profil berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProfileResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/profile/{id}:
    put:
      summary: Update profile
      description: Mengupdate data profil dengan validasi role-based access
      tags:
        - Profile
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Profile ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProfileRequest'
      responses:
        '200':
          description: Data profil berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateProfileResponse'
        '400':
          description: Validasi gagal atau data tidak berubah
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete profile
      description: Menghapus profil dengan validasi role-based access
      tags:
        - Profile
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Profile ID
      responses:
        '200':
          description: Profil berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # SETTINGS PROVINSI ENDPOINTS
  # ============================================
  /api/settings/provinsi:
    get:
      summary: Get list of provinces
      description: Mendapatkan daftar provinsi dengan pagination, filtering, dan caching Redis
      tags:
        - Settings - Provinsi
      security:
        - bearerAuth: []
      parameters:
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Filter by province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Filter by province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Filter by province name
        - name: pulau
          in: query
          schema:
            type: string
            enum:
              [
                'PAPUA',
                'KALIMANTAN',
                'SUMATERA',
                'SULAWESI',
                'JAWA',
                'TIMOR',
                'HALMAHERA',
                'SERAM',
                'SUMBAWA',
                'FLORES',
              ]
          description: Filter by island
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Filter by status
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: order_by
          in: query
          schema:
            type: string
            default: 'created_at ASC'
          description: Order by field
      responses:
        '200':
          description: Daftar provinsi berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProvinsiListResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create new province
      description: Membuat provinsi baru dengan validasi lengkap
      tags:
        - Settings - Provinsi
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProvinsiRequest'
      responses:
        '200':
          description: Provinsi berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateProvinsiResponse'
        '400':
          description: Validasi gagal atau data sudah ada
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/provinsi/single:
    get:
      summary: Get single province
      description: Mendapatkan data satu provinsi dengan caching Redis
      tags:
        - Settings - Provinsi
      security:
        - bearerAuth: []
      parameters:
        - name: ids_provinsi
          in: query
          schema:
            type: integer
          description: Province ID
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Province code
        - name: provinsi
          in: query
          schema:
            type: string
          description: Province name
        - name: pulau
          in: query
          schema:
            type: string
            enum:
              [
                'PAPUA',
                'KALIMANTAN',
                'SUMATERA',
                'SULAWESI',
                'JAWA',
                'TIMOR',
                'HALMAHERA',
                'SERAM',
                'SUMBAWA',
                'FLORES',
              ]
          description: Island
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Status
      responses:
        '200':
          description: Data provinsi berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProvinsiResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/provinsi/{id}:
    put:
      summary: Update province
      description: Mengupdate data provinsi dengan validasi role-based access
      tags:
        - Settings - Provinsi
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Province ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProvinsiRequest'
      responses:
        '200':
          description: Data provinsi berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateProvinsiResponse'
        '400':
          description: Validasi gagal atau data tidak berubah
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete province
      description: Menghapus provinsi dengan validasi role-based access
      tags:
        - Settings - Provinsi
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Province ID
      responses:
        '200':
          description: Provinsi berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # SETTINGS KABUPATEN/KOTA ENDPOINTS
  # ============================================
  /api/settings/kab-kota:
    get:
      summary: Get list of regencies/cities
      description: Mendapatkan daftar kabupaten/kota dengan pagination, filtering, dan caching Redis
      tags:
        - Settings - Kabupaten/Kota
      security:
        - bearerAuth: []
      parameters:
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city codes (comma separated)
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Filter by province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Filter by province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Filter by province name
        - name: kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city name
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Filter by status
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: order_by
          in: query
          schema:
            type: string
            default: 'created_at ASC'
          description: Order by field
      responses:
        '200':
          description: Daftar kabupaten/kota berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KabKotaListResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create new regency/city
      description: Membuat kabupaten/kota baru dengan validasi lengkap
      tags:
        - Settings - Kabupaten/Kota
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKabKotaRequest'
      responses:
        '200':
          description: Kabupaten/kota berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateKabKotaResponse'
        '400':
          description: Validasi gagal atau data sudah ada
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/kab-kota/single:
    get:
      summary: Get single regency/city
      description: Mendapatkan data satu kabupaten/kota dengan caching Redis
      tags:
        - Settings - Kabupaten/Kota
      security:
        - bearerAuth: []
      parameters:
        - name: ids_kabkota
          in: query
          schema:
            type: integer
          description: Regency/city ID
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Regency/city code
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Province name
        - name: kabkota
          in: query
          schema:
            type: string
          description: Regency/city name
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Status
      responses:
        '200':
          description: Data kabupaten/kota berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KabKotaResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/kab-kota/{id}:
    put:
      summary: Update regency/city
      description: Mengupdate data kabupaten/kota dengan validasi role-based access
      tags:
        - Settings - Kabupaten/Kota
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Regency/city ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKabKotaRequest'
      responses:
        '200':
          description: Data kabupaten/kota berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateKabKotaResponse'
        '400':
          description: Validasi gagal atau data tidak berubah
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete regency/city
      description: Menghapus kabupaten/kota dengan validasi role-based access
      tags:
        - Settings - Kabupaten/Kota
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Regency/city ID
      responses:
        '200':
          description: Kabupaten/kota berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # SETTINGS KECAMATAN ENDPOINTS
  # ============================================
  /api/settings/kecamatan:
    get:
      summary: Get list of districts
      description: Mendapatkan daftar kecamatan dengan pagination, filtering, dan caching Redis
      tags:
        - Settings - Kecamatan
      security:
        - bearerAuth: []
      parameters:
        - name: ids_kecamatan
          in: query
          schema:
            type: string
          description: Filter by district IDs (comma separated)
        - name: kode_kecamatan
          in: query
          schema:
            type: string
          description: Filter by district codes (comma separated)
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city codes (comma separated)
        - name: kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city name
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Filter by province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Filter by province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Filter by province name
        - name: kecamatan
          in: query
          schema:
            type: string
          description: Filter by district name
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Filter by status
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: order_by
          in: query
          schema:
            type: string
            default: 'created_at ASC'
          description: Order by field
      responses:
        '200':
          description: Daftar kecamatan berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KecamatanListResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create new district
      description: Membuat kecamatan baru dengan validasi lengkap
      tags:
        - Settings - Kecamatan
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKecamatanRequest'
      responses:
        '200':
          description: Kecamatan berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateKecamatanResponse'
        '400':
          description: Validasi gagal atau data sudah ada
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/kecamatan/single:
    get:
      summary: Get single district
      description: Mendapatkan data satu kecamatan dengan caching Redis
      tags:
        - Settings - Kecamatan
      security:
        - bearerAuth: []
      parameters:
        - name: ids_kecamatan
          in: query
          schema:
            type: integer
          description: District ID
        - name: kode_kecamatan
          in: query
          schema:
            type: string
          description: District code
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: Regency/city IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Regency/city codes (comma separated)
        - name: kabkota
          in: query
          schema:
            type: string
          description: Regency/city name
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Province name
        - name: kecamatan
          in: query
          schema:
            type: string
          description: District name
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Status
      responses:
        '200':
          description: Data kecamatan berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KecamatanResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/kecamatan/{id}:
    put:
      summary: Update district
      description: Mengupdate data kecamatan dengan validasi role-based access
      tags:
        - Settings - Kecamatan
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: District ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKecamatanRequest'
      responses:
        '200':
          description: Data kecamatan berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateKecamatanResponse'
        '400':
          description: Validasi gagal atau data tidak berubah
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete district
      description: Menghapus kecamatan dengan validasi role-based access
      tags:
        - Settings - Kecamatan
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: District ID
      responses:
        '200':
          description: Kecamatan berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  # ============================================
  # SETTINGS KELURAHAN ENDPOINTS
  # ============================================
  /api/settings/kelurahan:
    get:
      summary: Get list of villages
      description: Mendapatkan daftar kelurahan dengan pagination, filtering, dan caching Redis
      tags:
        - Settings - Kelurahan
      security:
        - bearerAuth: []
      parameters:
        - name: ids_kelurahan
          in: query
          schema:
            type: string
          description: Filter by village IDs (comma separated)
        - name: kode_kelurahan
          in: query
          schema:
            type: string
          description: Filter by village codes (comma separated)
        - name: ids_kecamatan
          in: query
          schema:
            type: string
          description: Filter by district IDs (comma separated)
        - name: kode_kecamatan
          in: query
          schema:
            type: string
          description: Filter by district codes (comma separated)
        - name: kecamatan
          in: query
          schema:
            type: string
          description: Filter by district name
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city codes (comma separated)
        - name: kabkota
          in: query
          schema:
            type: string
          description: Filter by regency/city name
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Filter by province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Filter by province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Filter by province name
        - name: kelurahan
          in: query
          schema:
            type: string
          description: Filter by village name
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Filter by status
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: order_by
          in: query
          schema:
            type: string
            default: 'created_at ASC'
          description: Order by field
      responses:
        '200':
          description: Daftar kelurahan berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KelurahanListResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create new village
      description: Membuat kelurahan baru dengan validasi lengkap
      tags:
        - Settings - Kelurahan
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKelurahanRequest'
      responses:
        '200':
          description: Kelurahan berhasil dibuat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateKelurahanResponse'
        '400':
          description: Validasi gagal atau data sudah ada
        '401':
          description: Akses ditolak
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/kelurahan/single:
    get:
      summary: Get single village
      description: Mendapatkan data satu kelurahan dengan caching Redis
      tags:
        - Settings - Kelurahan
      security:
        - bearerAuth: []
      parameters:
        - name: ids_kelurahan
          in: query
          schema:
            type: integer
          description: Village ID
        - name: kode_kelurahan
          in: query
          schema:
            type: string
          description: Village code
        - name: ids_kecamatan
          in: query
          schema:
            type: string
          description: District IDs (comma separated)
        - name: kode_kecamatan
          in: query
          schema:
            type: string
          description: District codes (comma separated)
        - name: kecamatan
          in: query
          schema:
            type: string
          description: District name
        - name: ids_kabkota
          in: query
          schema:
            type: string
          description: Regency/city IDs (comma separated)
        - name: kode_kabkota
          in: query
          schema:
            type: string
          description: Regency/city codes (comma separated)
        - name: kabkota
          in: query
          schema:
            type: string
          description: Regency/city name
        - name: ids_provinsi
          in: query
          schema:
            type: string
          description: Province IDs (comma separated)
        - name: kode_provinsi
          in: query
          schema:
            type: string
          description: Province codes (comma separated)
        - name: provinsi
          in: query
          schema:
            type: string
          description: Province name
        - name: kelurahan
          in: query
          schema:
            type: string
          description: Village name
        - name: status
          in: query
          schema:
            type: string
            enum: ['YA', 'TIDAK']
          description: Status
      responses:
        '200':
          description: Data kelurahan berhasil diambil
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KelurahanResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

  /api/settings/kelurahan/{id}:
    put:
      summary: Update village
      description: Mengupdate data kelurahan dengan validasi role-based access
      tags:
        - Settings - Kelurahan
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Village ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKelurahanRequest'
      responses:
        '200':
          description: Data kelurahan berhasil diupdate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateKelurahanResponse'
        '400':
          description: Validasi gagal atau data tidak berubah
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete village
      description: Menghapus kelurahan dengan validasi role-based access
      tags:
        - Settings - Kelurahan
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Village ID
      responses:
        '200':
          description: Kelurahan berhasil dihapus
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          description: Akses ditolak
        '404':
          description: Data tidak ditemukan
        '500':
          $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    # Schema untuk responses umum
    APIInfo:
      type: object
      properties:
        status:
          type: string
          example: 'success'
        message:
          type: string
          example: 'API PPBI - Persatuan Penggemar Bonsai Indonesia'
        version:
          type: string
          example: '1.2.0'
        documentation:
          type: object
          properties:
            url:
              type: string
            description:
              type: string
        endpoints:
          type: object
          properties:
            docs:
              type: string
            api_spec:
              type: string
            health_check:
              type: string
            api_base:
              type: string

    APIHealth:
      type: object
      properties:
        status:
          type: string
          example: 'OK'
        message:
          type: string
          example: 'API PPBI is healthy'
        timestamp:
          type: string
          format: date-time
        documentation:
          type: string

    DocsHealth:
      type: object
      properties:
        status:
          type: string
          example: 'HEALTHY'
        timestamp:
          type: string
          format: date-time
        port:
          type: integer
          example: 5000
        documentation:
          type: object
          properties:
            swagger_html:
              type: object
              properties:
                status:
                  type: string
                size:
                  type: string
            openapi_yaml:
              type: object
              properties:
                status:
                  type: string
                size:
                  type: string
        access_urls:
          type: object
          properties:
            docs:
              type: string
            api_spec:
              type: string

    ErrorResponse:
      type: object
      properties:
        code:
          type: integer
        status:
          type: string
        message:
          type: string
        path:
          type: string
        method:
          type: string

    # Schema untuk autentikasi
    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          minLength: 4
          maxLength: 20
          pattern: '^[a-zA-Z0-9._]+$'
          example: 'user123'
        password:
          type: string
          minLength: 8
          example: 'Password123!'

    LoginResponse:
      type: object
      properties:
        token:
          type: string
          description: JWT token untuk autentikasi

    RegisterRequest:
      type: object
      required:
        - username
        - password
        - confirm_password
      properties:
        username:
          type: string
          minLength: 4
          maxLength: 20
          pattern: '^[a-zA-Z0-9._]+$'
          example: 'newuser'
        password:
          type: string
          minLength: 8
          example: 'StrongPass123!'
        confirm_password:
          type: string
          example: 'StrongPass123!'
        reset:
          type: string
          enum: ['YA', 'TIDAK']
          default: 'TIDAK'

    RegisterResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        id_user:
          type: integer
          example: 123

    LogoutResponse:
      type: object
      properties:
        message:
          type: string
          example: 'You have successfully logged out!'

    CheckTokenResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Your token is still active'

    CreateTokenRequest:
      type: object
      required:
        - payload
      properties:
        payload:
          type: object
          description: Payload untuk JWT token

    RefreshTokenRequest:
      type: object
      required:
        - payload
      properties:
        payload:
          type: object
          description: Payload baru untuk JWT token

    DeleteTokenRequest:
      type: object
      properties:
        keterangan:
          type: string
          example: 'LOGOUT'

    TokenResponse:
      type: object
      properties:
        message:
          type: string
        token:
          type: string

    # Schema untuk JWT payload
    JWTPayload:
      type: object
      properties:
        userTime:
          type: string
        app:
          type: string
        id_user:
          type: integer
        nama:
          type: string
        email:
          type: string
        username:
          type: string
        nmr_tlpn:
          type: string
        mandiri:
          type: string
        ids_level:
          type: integer
        level:
          type: string
        tingkat:
          type: string
        ids_grup:
          type: integer
        grup:
          type: string
        keterangan:
          type: string
        login_as:
          type: string
        id_admin:
          type: integer

    # Schema untuk users management
    UsersListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/UserData'
        pagination:
          $ref: '#/components/schemas/Pagination'

    UserResponse:
      type: object
      properties:
        id_user:
          type: integer
        username:
          type: string
        ids_level:
          type: integer
        level:
          type: string
        tingkat:
          type: integer
        ids_grup:
          type: integer
        grup:
          type: string
        keterangan:
          type: string
        reset:
          type: string
          enum: ['YA', 'TIDAK']
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    UserData:
      type: object
      properties:
        id_user:
          type: integer
        username:
          type: string
        ids_level:
          type: integer
        level:
          type: string
        tingkat:
          type: integer
        ids_grup:
          type: integer
        grup:
          type: string
        keterangan:
          type: string
        reset:
          type: string
          enum: ['YA', 'TIDAK']
        import:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateUserRequest:
      type: object
      required:
        - ids_grup
        - username
        - password
        - reset
      properties:
        ids_grup:
          type: integer
          example: 8
        username:
          type: string
          minLength: 3
          maxLength: 50
          pattern: '^[a-zA-Z0-9._]+$'
          example: 'user123'
        password:
          type: string
          minLength: 8
          example: 'Password123!'
        confirm_password:
          type: string
          example: 'Password123!'
        reset:
          type: string
          enum: ['YA', 'TIDAK']
          default: 'TIDAK'
        created_by:
          type: integer
          description: Untuk admin level tinggi

    CreateUserResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        id_user:
          type: integer
          example: 123

    UpdateUserRequest:
      type: object
      properties:
        ids_grup:
          type: integer
          example: 8
        username:
          type: string
          minLength: 3
          maxLength: 50
          pattern: '^[a-zA-Z0-9._]+$'
          example: 'updated_user'
        password:
          type: string
          minLength: 8
          example: 'NewPassword123!'
        confirm_password:
          type: string
          example: 'NewPassword123!'
        reset:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'TIDAK'

    ImportResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Import data berhasil'
        success:
          type: integer
          example: 10
        failed:
          type: integer
          example: 2
        details:
          type: object
          properties:
            success_rows:
              type: array
              items:
                type: integer
            failed_rows:
              type: array
              items:
                type: object
                properties:
                  row_number:
                    type: integer
                  error:
                    type: string

    PreviewResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Preview file Excel berhasil.'
        file_info:
          type: object
          properties:
            total_rows:
              type: integer
            valid_rows:
              type: integer
            invalid_rows:
              type: integer
            duplicate_rows:
              type: integer
            ready_to_import:
              type: boolean
        column_mapping:
          type: object
          properties:
            mapped:
              type: object
            optional_columns:
              type: object
        preview_data:
          type: array
          items:
            type: object
            properties:
              row_number:
                type: integer
              data:
                type: array
                items:
                  type: string
              is_header:
                type: boolean
              validation_message:
                type: string
        validation_summary:
          type: object
          properties:
            is_valid:
              type: boolean
            structure_valid:
              type: boolean
            no_duplicates:
              type: boolean
            has_valid_data:
              type: boolean
        errors:
          type: object
          properties:
            structure_errors:
              type: array
              items:
                type: string
            duplicate_errors:
              type: array
              items:
                type: string
            total_structure_errors:
              type: integer
            total_duplicate_errors:
              type: integer

    # Schema untuk profile management
    ProfileListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ProfileData'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ProfileResponse:
      type: object
      properties:
        id_profile:
          type: integer
        id_user:
          type: integer
        username:
          type: string
        ids_level:
          type: integer
        level:
          type: string
        tingkat:
          type: integer
        ids_grup:
          type: integer
        grup:
          type: string
        nama_lengkap:
          type: string
        jenis_kelamin:
          type: string
          enum: ['LAKI-LAKI', 'PEREMPUAN']
        ids_kelurahan:
          type: integer
        kode_kelurahan:
          type: string
        kelurahan:
          type: string
        ids_kecamatan:
          type: integer
        kode_kecamatan:
          type: string
        kecamatan:
          type: string
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        pulau:
          type: string
        rw:
          type: string
        rt:
          type: string
        alamat:
          type: string
        nmr_tlpn:
          type: string
        foto:
          type: string
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    ProfileData:
      type: object
      properties:
        id_profile:
          type: integer
        id_user:
          type: integer
        username:
          type: string
        ids_level:
          type: integer
        level:
          type: string
        tingkat:
          type: integer
        ids_grup:
          type: integer
        grup:
          type: string
        nama_lengkap:
          type: string
        jenis_kelamin:
          type: string
          enum: ['LAKI-LAKI', 'PEREMPUAN']
        ids_kelurahan:
          type: integer
        kode_kelurahan:
          type: string
        kelurahan:
          type: string
        ids_kecamatan:
          type: integer
        kode_kecamatan:
          type: string
        kecamatan:
          type: string
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        pulau:
          type: string
        rw:
          type: string
        rt:
          type: string
        alamat:
          type: string
        nmr_tlpn:
          type: string
        foto:
          type: string
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateProfileRequest:
      type: object
      required:
        - nama_lengkap
        - jenis_kelamin
      properties:
        nama_lengkap:
          type: string
          minLength: 3
          maxLength: 255
          example: 'Budi Santoso'
        jenis_kelamin:
          type: string
          enum: ['LAKI-LAKI', 'PEREMPUAN']
          example: 'LAKI-LAKI'
        ids_kelurahan:
          type: integer
          example: 123
        rw:
          type: string
          minLength: 1
          maxLength: 5
          example: '02'
        rt:
          type: string
          minLength: 1
          maxLength: 5
          example: '03'
        alamat:
          type: string
          example: 'Jl. Merdeka No. 1, Kelurahan Contoh, Kecamatan Contoh'
        nmr_tlpn:
          type: string
          minLength: 10
          maxLength: 20
          example: '081234567890'
        foto:
          type: string
          example: 'https://example.com/foto.jpg'
        created_by:
          type: integer
          description: Untuk admin level tinggi

    CreateProfileResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        id_profile:
          type: integer
          example: 456

    UpdateProfileRequest:
      type: object
      properties:
        nama_lengkap:
          type: string
          minLength: 3
          maxLength: 255
          example: 'Budi Santoso Updated'
        jenis_kelamin:
          type: string
          enum: ['LAKI-LAKI', 'PEREMPUAN']
          example: 'LAKI-LAKI'
        ids_kelurahan:
          type: integer
          example: 123
        rw:
          type: string
          minLength: 1
          maxLength: 5
          example: '02'
        rt:
          type: string
          minLength: 1
          maxLength: 5
          example: '03'
        alamat:
          type: string
          example: 'Jl. Merdeka No. 1 Updated, Kelurahan Contoh, Kecamatan Contoh'
        nmr_tlpn:
          type: string
          minLength: 10
          maxLength: 20
          example: '081234567890'
        foto:
          type: string
          example: 'https://example.com/foto-updated.jpg'

    UpdateProfileResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data changed successfully.'
        id_profile:
          type: integer
          example: 456

    # Schema untuk settings provinsi
    ProvinsiListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ProvinsiData'
        pagination:
          $ref: '#/components/schemas/Pagination'

    ProvinsiResponse:
      type: object
      properties:
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        pulau:
          type: string
          enum:
            [
              'PAPUA',
              'KALIMANTAN',
              'SUMATERA',
              'SULAWESI',
              'JAWA',
              'TIMOR',
              'HALMAHERA',
              'SERAM',
              'SUMBAWA',
              'FLORES',
            ]
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    ProvinsiData:
      type: object
      properties:
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        pulau:
          type: string
          enum:
            [
              'PAPUA',
              'KALIMANTAN',
              'SUMATERA',
              'SULAWESI',
              'JAWA',
              'TIMOR',
              'HALMAHERA',
              'SERAM',
              'SUMBAWA',
              'FLORES',
            ]
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateProvinsiRequest:
      type: object
      required:
        - kode_provinsi
        - provinsi
        - pulau
        - status
      properties:
        kode_provinsi:
          type: string
          minLength: 1
          maxLength: 5
          example: '31'
          description: Kode provinsi (max 5 karakter)
        provinsi:
          type: string
          example: 'DKI JAKARTA'
          description: Nama provinsi
        pulau:
          type: string
          enum:
            [
              'PAPUA',
              'KALIMANTAN',
              'SUMATERA',
              'SULAWESI',
              'JAWA',
              'TIMOR',
              'HALMAHERA',
              'SERAM',
              'SUMBAWA',
              'FLORES',
            ]
          example: 'JAWA'
          description: Pulau tempat provinsi berada
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    CreateProvinsiResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        ids_provinsi:
          type: integer
          example: 1

    UpdateProvinsiRequest:
      type: object
      properties:
        kode_provinsi:
          type: string
          minLength: 1
          maxLength: 5
          example: '31'
          description: Kode provinsi (max 5 karakter)
        provinsi:
          type: string
          example: 'DKI JAKARTA Updated'
          description: Nama provinsi
        pulau:
          type: string
          enum:
            [
              'PAPUA',
              'KALIMANTAN',
              'SUMATERA',
              'SULAWESI',
              'JAWA',
              'TIMOR',
              'HALMAHERA',
              'SERAM',
              'SUMBAWA',
              'FLORES',
            ]
          example: 'JAWA'
          description: Pulau tempat provinsi berada
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    UpdateProvinsiResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data changed successfully.'
        ids_provinsi:
          type: integer
          example: 1

    # Schema untuk settings kabupaten/kota
    KabKotaListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/KabKotaData'
        pagination:
          $ref: '#/components/schemas/Pagination'

    KabKotaResponse:
      type: object
      properties:
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        kabkota:
          type: string
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    KabKotaData:
      type: object
      properties:
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        kabkota:
          type: string
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateKabKotaRequest:
      type: object
      required:
        - kode_kabkota
        - ids_provinsi
        - kabkota
        - status
      properties:
        kode_kabkota:
          type: string
          minLength: 1
          maxLength: 10
          example: '31.01'
          description: Kode kabupaten/kota (max 10 karakter)
        ids_provinsi:
          type: integer
          example: 1
          description: ID provinsi (foreign key)
        kabkota:
          type: string
          example: 'KABUPATEN ADM. KEPULAUAN SERIBU'
          description: Nama kabupaten/kota
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    CreateKabKotaResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        ids_kabkota:
          type: integer
          example: 1

    UpdateKabKotaRequest:
      type: object
      properties:
        kode_kabkota:
          type: string
          minLength: 1
          maxLength: 10
          example: '31.01'
          description: Kode kabupaten/kota (max 10 karakter)
        ids_provinsi:
          type: integer
          example: 1
          description: ID provinsi (foreign key)
        kabkota:
          type: string
          example: 'KABUPATEN ADM. KEPULAUAN SERIBU Updated'
          description: Nama kabupaten/kota
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    UpdateKabKotaResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data changed successfully.'
        ids_kabkota:
          type: integer
          example: 1

    # Schema untuk settings kecamatan
    KecamatanListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/KecamatanData'
        pagination:
          $ref: '#/components/schemas/Pagination'

    KecamatanResponse:
      type: object
      properties:
        ids_kecamatan:
          type: integer
        kode_kecamatan:
          type: string
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        kecamatan:
          type: string
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    KecamatanData:
      type: object
      properties:
        ids_kecamatan:
          type: integer
        kode_kecamatan:
          type: string
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        kecamatan:
          type: string
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateKecamatanRequest:
      type: object
      required:
        - kode_kecamatan
        - ids_kabkota
        - kecamatan
        - status
      properties:
        kode_kecamatan:
          type: string
          minLength: 1
          maxLength: 10
          example: '31.01.01'
          description: Kode kecamatan (max 10 karakter)
        ids_kabkota:
          type: integer
          example: 1
          description: ID kabupaten/kota (foreign key)
        kecamatan:
          type: string
          example: 'KEPULAUAN SERIBU SELATAN'
          description: Nama kecamatan
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    CreateKecamatanResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        ids_kecamatan:
          type: integer
          example: 1

    UpdateKecamatanRequest:
      type: object
      properties:
        kode_kecamatan:
          type: string
          minLength: 1
          maxLength: 10
          example: '31.01.01'
          description: Kode kecamatan (max 10 karakter)
        ids_kabkota:
          type: integer
          example: 1
          description: ID kabupaten/kota (foreign key)
        kecamatan:
          type: string
          example: 'KEPULAUAN SERIBU SELATAN Updated'
          description: Nama kecamatan
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    UpdateKecamatanResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data changed successfully.'
        ids_kecamatan:
          type: integer
          example: 1

    # Schema untuk settings kelurahan
    KelurahanListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/KelurahanData'
        pagination:
          $ref: '#/components/schemas/Pagination'

    KelurahanResponse:
      type: object
      properties:
        ids_kelurahan:
          type: integer
        kode_kelurahan:
          type: string
        ids_kecamatan:
          type: integer
        kode_kecamatan:
          type: string
        kecamatan:
          type: string
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        kelurahan:
          type: string
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    KelurahanData:
      type: object
      properties:
        ids_kelurahan:
          type: integer
        kode_kelurahan:
          type: string
        ids_kecamatan:
          type: integer
        kode_kecamatan:
          type: string
        kecamatan:
          type: string
        ids_kabkota:
          type: integer
        kode_kabkota:
          type: string
        kabkota:
          type: string
        ids_provinsi:
          type: integer
        kode_provinsi:
          type: string
        provinsi:
          type: string
        kelurahan:
          type: string
        status:
          type: string
          enum: ['YA', 'TIDAK']
        created_by:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateKelurahanRequest:
      type: object
      required:
        - kode_kelurahan
        - ids_kecamatan
        - kelurahan
        - status
      properties:
        kode_kelurahan:
          type: string
          minLength: 1
          maxLength: 15
          example: '31.01.01.1001'
          description: Kode kelurahan (max 15 karakter)
        ids_kecamatan:
          type: integer
          example: 1
          description: ID kecamatan (foreign key)
        kelurahan:
          type: string
          example: 'PULAU TIDUNG'
          description: Nama kelurahan
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    CreateKelurahanResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data added successfully.'
        ids_kelurahan:
          type: integer
          example: 1

    UpdateKelurahanRequest:
      type: object
      properties:
        kode_kelurahan:
          type: string
          minLength: 1
          maxLength: 15
          example: '31.01.01.1001'
          description: Kode kelurahan (max 15 karakter)
        ids_kecamatan:
          type: integer
          example: 1
          description: ID kecamatan (foreign key)
        kelurahan:
          type: string
          example: 'PULAU TIDUNG Updated'
          description: Nama kelurahan
        status:
          type: string
          enum: ['YA', 'TIDAK']
          example: 'YA'
          description: Status aktif/tidak aktif

    UpdateKelurahanResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data changed successfully.'
        ids_kelurahan:
          type: integer
          example: 1

    # Schema untuk pagination
    Pagination:
      type: object
      properties:
        total:
          type: integer
        per_page:
          type: integer
        current_page:
          type: integer
        last_page:
          type: integer
        from:
          type: integer
        to:
          type: integer

    # Schema untuk success response
    SuccessResponse:
      type: object
      properties:
        message:
          type: string
          example: 'Data changed successfully.'

    # Schema untuk request excel
    ExcelTemplateRequest:
      type: object
      properties:
        template_type:
          type: string
          enum: ['basic', 'advanced']
          default: 'basic'

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    googleOAuth:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://accounts.google.com/o/oauth2/auth
          tokenUrl: https://accounts.google.com/o/oauth2/token
          scopes:
            'https://www.googleapis.com/auth/userinfo.email': Akses email
            'https://www.googleapis.com/auth/userinfo.profile': Akses profile
            openid: OpenID Connect

security:
  - bearerAuth: []
